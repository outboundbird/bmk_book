<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Power and sample size | _main.knit</title>
  <meta name="description" content="" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Power and sample size | _main.knit" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Power and sample size | _main.knit" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiplicity.html"/>
<link rel="next" href="detection-limit-of-assays.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="biology.html"><a href="biology.html"><i class="fa fa-check"></i><b>2</b> Basic biology</a><ul>
<li class="chapter" data-level="2.1" data-path="biology.html"><a href="biology.html#blood-samples"><i class="fa fa-check"></i><b>2.1</b> Blood samples</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cell-type.html"><a href="cell-type.html"><i class="fa fa-check"></i><b>3</b> Cell type</a><ul>
<li class="chapter" data-level="3.1" data-path="cell-type.html"><a href="cell-type.html#flowcytometry-data"><i class="fa fa-check"></i><b>3.1</b> flowcytometry data</a></li>
<li class="chapter" data-level="3.2" data-path="cell-type.html"><a href="cell-type.html#cell-type-deconvolution"><i class="fa fa-check"></i><b>3.2</b> Cell type deconvolution</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html"><i class="fa fa-check"></i><b>4</b> Bulk RNA seqeuncing analysis</a><ul>
<li class="chapter" data-level="4.1" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#preprocessing"><i class="fa fa-check"></i><b>4.1</b> Preprocessing</a><ul>
<li class="chapter" data-level="4.1.1" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#filtering"><i class="fa fa-check"></i><b>4.1.1</b> Filtering</a></li>
<li class="chapter" data-level="4.1.2" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#normalization"><i class="fa fa-check"></i><b>4.1.2</b> Normalization</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#differential-expression-analysis"><i class="fa fa-check"></i><b>4.2</b> Differential expression analysis</a></li>
<li class="chapter" data-level="4.3" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#differential-co-expression-analysis"><i class="fa fa-check"></i><b>4.3</b> Differential co-expression analysis</a></li>
<li class="chapter" data-level="4.4" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#pathway-analysis"><i class="fa fa-check"></i><b>4.4</b> Pathway analysis</a><ul>
<li class="chapter" data-level="4.4.1" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#gene-set-enrichment-analysis-gsea"><i class="fa fa-check"></i><b>4.4.1</b> Gene set enrichment analysis (GSEA)</a></li>
<li class="chapter" data-level="4.4.2" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#single-sample-gene-set-enrichment-analysis-ssgsea"><i class="fa fa-check"></i><b>4.4.2</b> Single sample gene set enrichment analysis (ssGSEA)</a></li>
<li class="chapter" data-level="4.4.3" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#gene-set-variation-analysis-gsva"><i class="fa fa-check"></i><b>4.4.3</b> Gene set variation analysis (GSVA)</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="bulk-rna-seqeuncing-analysis.html"><a href="bulk-rna-seqeuncing-analysis.html#clustering"><i class="fa fa-check"></i><b>4.5</b> Clustering</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="Nanostring.html"><a href="Nanostring.html"><i class="fa fa-check"></i><b>5</b> Nanostring technology</a></li>
<li class="chapter" data-level="6" data-path="proteinomics.html"><a href="proteinomics.html"><i class="fa fa-check"></i><b>6</b> Proteinomics</a><ul>
<li class="chapter" data-level="6.1" data-path="proteinomics.html"><a href="proteinomics.html#olink"><i class="fa fa-check"></i><b>6.1</b> OLINK</a></li>
<li class="chapter" data-level="6.2" data-path="proteinomics.html"><a href="proteinomics.html#semalogic"><i class="fa fa-check"></i><b>6.2</b> Semalogic</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html"><i class="fa fa-check"></i><b>7</b> Pharmacogenetics analysis</a><ul>
<li class="chapter" data-level="7.1" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html#basic-genetic-concepts"><i class="fa fa-check"></i><b>7.1</b> Basic genetic concepts</a></li>
<li class="chapter" data-level="7.2" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html#pharmacoscan"><i class="fa fa-check"></i><b>7.2</b> Pharmacoscan</a><ul>
<li class="chapter" data-level="7.2.1" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html#software-for-analysis"><i class="fa fa-check"></i><b>7.2.1</b> Software for analysis</a></li>
<li class="chapter" data-level="7.2.2" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html#single-nucleotide-variant-data"><i class="fa fa-check"></i><b>7.2.2</b> Single nucleotide variant data</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html#hla-region-targeted-sequencing"><i class="fa fa-check"></i><b>7.3</b> HLA region targeted sequencing</a><ul>
<li class="chapter" data-level="7.3.1" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html#hla-nomenclature-and-sequencing-output"><i class="fa fa-check"></i><b>7.3.1</b> HLA nomenclature and sequencing output</a></li>
<li class="chapter" data-level="7.3.2" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html#drb1-and-drb3drb4drb5"><i class="fa fa-check"></i><b>7.3.2</b> DRB1 and DRB3/DRB4/DRB5</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="pharmacogenetics-analysis.html"><a href="pharmacogenetics-analysis.html#reference"><i class="fa fa-check"></i><b>7.4</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="multiplicity.html"><a href="multiplicity.html"><i class="fa fa-check"></i><b>8</b> Multiplicity</a><ul>
<li class="chapter" data-level="8.1" data-path="multiplicity.html"><a href="multiplicity.html#family-wise-comparison"><i class="fa fa-check"></i><b>8.1</b> Family wise comparison</a></li>
<li class="chapter" data-level="8.2" data-path="multiplicity.html"><a href="multiplicity.html#false-discovery-rate-fdr"><i class="fa fa-check"></i><b>8.2</b> False discovery rate (FDR)</a></li>
<li class="chapter" data-level="8.3" data-path="multiplicity.html"><a href="multiplicity.html#local-fdr"><i class="fa fa-check"></i><b>8.3</b> Local FDR</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html"><i class="fa fa-check"></i><b>9</b> Power and sample size</a><ul>
<li class="chapter" data-level="9.1" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#sample-size-calculation-in-in-vitro-studies"><i class="fa fa-check"></i><b>9.1</b> Sample size calculation in <em>in vitro</em> studies</a></li>
<li class="chapter" data-level="9.2" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#sample-size-calculation-in-omics-studies"><i class="fa fa-check"></i><b>9.2</b> Sample size calculation in <em>omics</em> studies</a></li>
<li class="chapter" data-level="9.3" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#sample-size-calculation-for-calibration-studies"><i class="fa fa-check"></i><b>9.3</b> Sample size calculation for calibration studies</a><ul>
<li class="chapter" data-level="9.3.1" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#agreement-between-two-measurements"><i class="fa fa-check"></i><b>9.3.1</b> 1. Agreement between two measurements</a></li>
<li class="chapter" data-level="9.3.2" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#sample-size-for-calibrations"><i class="fa fa-check"></i><b>9.3.2</b> 2. Sample size for calibrations</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#choosing-samples-range"><i class="fa fa-check"></i><b>9.4</b> Choosing samples range</a><ul>
<li class="chapter" data-level="9.4.1" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#estimating-coefficient-variation-cv-within-the-same-measures"><i class="fa fa-check"></i><b>9.4.1</b> Estimating coefficient variation (CV) within the same measures</a></li>
<li class="chapter" data-level="9.4.2" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#final-consideration-for-sample-size"><i class="fa fa-check"></i><b>9.4.2</b> Final consideration for sample size</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="power-and-sample-size.html"><a href="power-and-sample-size.html#reference-1"><i class="fa fa-check"></i><b>9.5</b> Reference</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="detection-limit-of-assays.html"><a href="detection-limit-of-assays.html"><i class="fa fa-check"></i><b>10</b> Detection limit of assays</a><ul>
<li class="chapter" data-level="10.1" data-path="detection-limit-of-assays.html"><a href="detection-limit-of-assays.html#upper-and-lower-detection-limit"><i class="fa fa-check"></i><b>10.1</b> Upper and lower detection limit</a></li>
<li class="chapter" data-level="10.2" data-path="detection-limit-of-assays.html"><a href="detection-limit-of-assays.html#violation-in-distribution-assumption"><i class="fa fa-check"></i><b>10.2</b> Violation in distribution assumption</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="visualization.html"><a href="visualization.html"><i class="fa fa-check"></i><b>11</b> Visualization</a><ul>
<li class="chapter" data-level="11.1" data-path="visualization.html"><a href="visualization.html#packages"><i class="fa fa-check"></i><b>11.1</b> packages</a></li>
<li class="chapter" data-level="11.2" data-path="visualization.html"><a href="visualization.html#basic-static-plot"><i class="fa fa-check"></i><b>11.2</b> Basic static plot</a></li>
<li class="chapter" data-level="11.3" data-path="visualization.html"><a href="visualization.html#special-plots"><i class="fa fa-check"></i><b>11.3</b> Special plots</a><ul>
<li class="chapter" data-level="11.3.1" data-path="visualization.html"><a href="visualization.html#genetic-analysis"><i class="fa fa-check"></i><b>11.3.1</b> Genetic analysis</a></li>
<li class="chapter" data-level="11.3.2" data-path="visualization.html"><a href="visualization.html#rna-seq-analysis"><i class="fa fa-check"></i><b>11.3.2</b> RNA seq analysis</a></li>
<li class="chapter" data-level="11.3.3" data-path="visualization.html"><a href="visualization.html#clustering-analysis"><i class="fa fa-check"></i><b>11.3.3</b> Clustering analysis</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"></a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="power-and-sample-size" class="section level1 hasAnchor">
<h1><span class="header-section-number">9</span> Power and sample size<a href="power-and-sample-size.html#power-and-sample-size" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="sample-size-calculation-in-in-vitro-studies" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.1</span> Sample size calculation in <em>in vitro</em> studies<a href="power-and-sample-size.html#sample-size-calculation-in-in-vitro-studies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="sample-size-calculation-in-omics-studies" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.2</span> Sample size calculation in <em>omics</em> studies<a href="power-and-sample-size.html#sample-size-calculation-in-omics-studies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Consideration of false positive results</p>
</div>
<div id="sample-size-calculation-for-calibration-studies" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.3</span> Sample size calculation for calibration studies<a href="power-and-sample-size.html#sample-size-calculation-for-calibration-studies" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="agreement-between-two-measurements" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.3.1</span> 1. Agreement between two measurements<a href="power-and-sample-size.html#agreement-between-two-measurements" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>assess the agreement of two measurements</li>
</ul>
<div id="inter-class-correlation-coefficient" class="section level4 hasAnchor">
<h4><span class="header-section-number">9.3.1.1</span> Inter-class correlation coefficient<a href="power-and-sample-size.html#inter-class-correlation-coefficient" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li>Pearson correlation</li>
<li>Spearman correlation</li>
</ul>
<p><span class="math display">\[ \frac{\sum_i\rho(G_{j}(Rseq), G_{j}(nano)))}{n_i}
\]</span></p>
<ul>
<li>i - number of genes</li>
<li>j - number of subjects</li>
</ul>
<p>Need to visually examine if there exist ceiling and flooring effect
between two measurements.</p>
</div>
<div id="intraclass-correlation-coefficient-icc" class="section level4 hasAnchor">
<h4><span class="header-section-number">9.3.1.2</span> Intraclass Correlation Coefficient (ICC)<a href="power-and-sample-size.html#intraclass-correlation-coefficient-icc" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Generally speaking, the ICC determines the reliability of ratings by
comparing the variability of different ratings of the same individuals
to the total variation across all ratings and all individuals.</p>
<ul>
<li>A high ICC (close to 1) indicates high similarity between values from
the same group.</li>
<li>A low ICC (ICC close to zero) means that values from the
same group are not similar.</li>
</ul>
<p>The sample size is calculated based on following parameter:</p>
<ul>
<li>ICC0 - ICC of null hypothesis (e.g. 0 no agreement or a value based on previous observations)</li>
<li>ICC - hypothetical ICC</li>
<li>alpha at 0.05</li>
<li>k = 2 (number of raters: nanostring vs. RNAseq)</li>
<li>two tails</li>
</ul>
<p><strong>Example calibration between RNAseq and nanostring measurements</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(ICC.Sample.Size)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">library</span>(kableExtra)</a>
<a class="sourceLine" id="cb1-4" title="4"><span class="kw">library</span>(dplyr)</a>
<a class="sourceLine" id="cb1-5" title="5"></a>
<a class="sourceLine" id="cb1-6" title="6">sample &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;RNAseq&quot;</span>, <span class="st">&quot;nanostring&quot;</span>), <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb1-7" title="7">genes &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(<span class="dv">30</span>), <span class="dt">ncol =</span> <span class="dv">6</span>)</a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">rownames</span>(genes) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;gene&quot;</span>, <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>))</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">colnames</span>(genes) &lt;-<span class="st"> </span>sample</a>
<a class="sourceLine" id="cb1-10" title="10"><span class="kw">kable</span>(genes, <span class="dt">digits =</span> <span class="dv">2</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-11" title="11"><span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;ID1&quot;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;ID2&quot;</span> =<span class="st"> </span><span class="dv">2</span>, <span class="st">&quot;ID3&quot;</span> =<span class="st"> </span><span class="dv">2</span>))</a></code></pre></div>
<table>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ID1
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ID2
</div>
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ID3
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
RNAseq
</th>
<th style="text-align:right;">
nanostring
</th>
<th style="text-align:right;">
RNAseq
</th>
<th style="text-align:right;">
nanostring
</th>
<th style="text-align:right;">
RNAseq
</th>
<th style="text-align:right;">
nanostring
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
gene1
</td>
<td style="text-align:right;">
0.55
</td>
<td style="text-align:right;">
-0.74
</td>
<td style="text-align:right;">
-1.20
</td>
<td style="text-align:right;">
-0.86
</td>
<td style="text-align:right;">
0.40
</td>
<td style="text-align:right;">
0.07
</td>
</tr>
<tr>
<td style="text-align:left;">
gene2
</td>
<td style="text-align:right;">
-2.79
</td>
<td style="text-align:right;">
-0.69
</td>
<td style="text-align:right;">
-0.13
</td>
<td style="text-align:right;">
0.26
</td>
<td style="text-align:right;">
0.18
</td>
<td style="text-align:right;">
-0.82
</td>
</tr>
<tr>
<td style="text-align:left;">
gene3
</td>
<td style="text-align:right;">
-1.93
</td>
<td style="text-align:right;">
0.28
</td>
<td style="text-align:right;">
-0.71
</td>
<td style="text-align:right;">
-1.26
</td>
<td style="text-align:right;">
0.10
</td>
<td style="text-align:right;">
-0.30
</td>
</tr>
<tr>
<td style="text-align:left;">
gene4
</td>
<td style="text-align:right;">
-1.45
</td>
<td style="text-align:right;">
-0.42
</td>
<td style="text-align:right;">
-0.57
</td>
<td style="text-align:right;">
0.06
</td>
<td style="text-align:right;">
1.06
</td>
<td style="text-align:right;">
0.25
</td>
</tr>
<tr>
<td style="text-align:left;">
gene5
</td>
<td style="text-align:right;">
2.11
</td>
<td style="text-align:right;">
1.19
</td>
<td style="text-align:right;">
1.69
</td>
<td style="text-align:right;">
-1.01
</td>
<td style="text-align:right;">
-1.58
</td>
<td style="text-align:right;">
0.64
</td>
</tr>
</tbody>
</table>
<p><em>Statistical power at 80%, single tail</em></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">k2a005p08 &lt;-<span class="st"> </span><span class="kw">calculateIccSampleSize</span>(<span class="dt">by =</span> <span class="st">&quot;both&quot;</span>, <span class="dt">tails =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">table_n &lt;-<span class="st"> </span>k2a005p08[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4">knitr<span class="op">::</span><span class="kw">kable</span>(table_n,</a>
<a class="sourceLine" id="cb2-5" title="5"><span class="dt">caption =</span> <span class="st">&quot;Table of sample size (N) given null and alterative hythosis of ICC.&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="st">  </span><span class="kw">column_spec</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">12</span>, <span class="dt">color =</span> <span class="kw">ifelse</span>(<span class="kw">rownames</span>(table_n) <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.5</span>, <span class="st">&quot;red&quot;</span>, <span class="dv">1</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="st">  </span><span class="kw">add_header_above</span>(<span class="kw">c</span>(<span class="st">&quot;&quot;</span>, <span class="st">&quot;ICC0&quot;</span> =<span class="st"> </span><span class="dv">20</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="st">  </span><span class="kw">pack_rows</span>(<span class="st">&quot;ICC&quot;</span>, <span class="dv">1</span>, <span class="dv">20</span>)</a></code></pre></div>
<table>
<caption>
<span id="tab:unnamed-chunk-2">Table 9.1: </span>Table of sample size (N) given null and alterative hythosis of ICC.
</caption>
<thead>
<tr>
<th style="empty-cells: hide;border-bottom:hidden;" colspan="1">
</th>
<th style="border-bottom:hidden;padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="20">
<div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
ICC0
</div>
</th>
</tr>
<tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
0
</th>
<th style="text-align:right;">
0.05
</th>
<th style="text-align:right;">
0.1
</th>
<th style="text-align:right;">
0.15
</th>
<th style="text-align:right;">
0.2
</th>
<th style="text-align:right;">
0.25
</th>
<th style="text-align:right;">
0.3
</th>
<th style="text-align:right;">
0.35
</th>
<th style="text-align:right;">
0.4
</th>
<th style="text-align:right;">
0.45
</th>
<th style="text-align:right;">
0.5
</th>
<th style="text-align:right;">
0.55
</th>
<th style="text-align:right;">
0.6
</th>
<th style="text-align:right;">
0.65
</th>
<th style="text-align:right;">
0.7
</th>
<th style="text-align:right;">
0.75
</th>
<th style="text-align:right;">
0.8
</th>
<th style="text-align:right;">
0.85
</th>
<th style="text-align:right;">
0.9
</th>
<th style="text-align:right;">
0.95
</th>
</tr>
</thead>
<tbody>
<tr grouplength="20">
<td colspan="21" style="border-bottom: 1px solid;">
<strong>ICC</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
2470
</td>
<td style="text-align:right;color: 1 !important;">
616
</td>
<td style="text-align:right;color: 1 !important;">
272
</td>
<td style="text-align:right;color: 1 !important;">
152
</td>
<td style="text-align:right;color: 1 !important;">
96
</td>
<td style="text-align:right;color: 1 !important;">
66
</td>
<td style="text-align:right;color: 1 !important;">
48
</td>
<td style="text-align:right;color: 1 !important;">
36
</td>
<td style="text-align:right;color: 1 !important;">
28
</td>
<td style="text-align:right;color: 1 !important;">
22
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.05
</td>
<td style="text-align:right;color: 1 !important;">
2470
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
2446
</td>
<td style="text-align:right;color: 1 !important;">
606
</td>
<td style="text-align:right;color: 1 !important;">
267
</td>
<td style="text-align:right;color: 1 !important;">
148
</td>
<td style="text-align:right;color: 1 !important;">
93
</td>
<td style="text-align:right;color: 1 !important;">
64
</td>
<td style="text-align:right;color: 1 !important;">
46
</td>
<td style="text-align:right;color: 1 !important;">
34
</td>
<td style="text-align:right;color: 1 !important;">
26
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
3
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.1
</td>
<td style="text-align:right;color: 1 !important;">
616
</td>
<td style="text-align:right;color: 1 !important;">
2446
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
2397
</td>
<td style="text-align:right;color: 1 !important;">
591
</td>
<td style="text-align:right;color: 1 !important;">
259
</td>
<td style="text-align:right;color: 1 !important;">
143
</td>
<td style="text-align:right;color: 1 !important;">
89
</td>
<td style="text-align:right;color: 1 !important;">
61
</td>
<td style="text-align:right;color: 1 !important;">
43
</td>
<td style="text-align:right;color: 1 !important;">
32
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
19
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.15
</td>
<td style="text-align:right;color: 1 !important;">
272
</td>
<td style="text-align:right;color: 1 !important;">
606
</td>
<td style="text-align:right;color: 1 !important;">
2397
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
2324
</td>
<td style="text-align:right;color: 1 !important;">
570
</td>
<td style="text-align:right;color: 1 !important;">
248
</td>
<td style="text-align:right;color: 1 !important;">
136
</td>
<td style="text-align:right;color: 1 !important;">
85
</td>
<td style="text-align:right;color: 1 !important;">
57
</td>
<td style="text-align:right;color: 1 !important;">
40
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.2
</td>
<td style="text-align:right;color: 1 !important;">
152
</td>
<td style="text-align:right;color: 1 !important;">
267
</td>
<td style="text-align:right;color: 1 !important;">
591
</td>
<td style="text-align:right;color: 1 !important;">
2324
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
2229
</td>
<td style="text-align:right;color: 1 !important;">
544
</td>
<td style="text-align:right;color: 1 !important;">
235
</td>
<td style="text-align:right;color: 1 !important;">
128
</td>
<td style="text-align:right;color: 1 !important;">
79
</td>
<td style="text-align:right;color: 1 !important;">
53
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.25
</td>
<td style="text-align:right;color: 1 !important;">
96
</td>
<td style="text-align:right;color: 1 !important;">
148
</td>
<td style="text-align:right;color: 1 !important;">
259
</td>
<td style="text-align:right;color: 1 !important;">
570
</td>
<td style="text-align:right;color: 1 !important;">
2229
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
2113
</td>
<td style="text-align:right;color: 1 !important;">
512
</td>
<td style="text-align:right;color: 1 !important;">
220
</td>
<td style="text-align:right;color: 1 !important;">
119
</td>
<td style="text-align:right;color: 1 !important;">
73
</td>
<td style="text-align:right;">
48
</td>
<td style="text-align:right;">
34
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.3
</td>
<td style="text-align:right;color: 1 !important;">
66
</td>
<td style="text-align:right;color: 1 !important;">
93
</td>
<td style="text-align:right;color: 1 !important;">
143
</td>
<td style="text-align:right;color: 1 !important;">
248
</td>
<td style="text-align:right;color: 1 !important;">
544
</td>
<td style="text-align:right;color: 1 !important;">
2113
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
1978
</td>
<td style="text-align:right;color: 1 !important;">
476
</td>
<td style="text-align:right;color: 1 !important;">
203
</td>
<td style="text-align:right;color: 1 !important;">
109
</td>
<td style="text-align:right;">
66
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
16
</td>
<td style="text-align:right;">
11
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.35
</td>
<td style="text-align:right;color: 1 !important;">
48
</td>
<td style="text-align:right;color: 1 !important;">
64
</td>
<td style="text-align:right;color: 1 !important;">
89
</td>
<td style="text-align:right;color: 1 !important;">
136
</td>
<td style="text-align:right;color: 1 !important;">
235
</td>
<td style="text-align:right;color: 1 !important;">
512
</td>
<td style="text-align:right;color: 1 !important;">
1978
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
1826
</td>
<td style="text-align:right;color: 1 !important;">
436
</td>
<td style="text-align:right;color: 1 !important;">
184
</td>
<td style="text-align:right;">
98
</td>
<td style="text-align:right;">
59
</td>
<td style="text-align:right;">
38
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
4
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.4
</td>
<td style="text-align:right;color: 1 !important;">
36
</td>
<td style="text-align:right;color: 1 !important;">
46
</td>
<td style="text-align:right;color: 1 !important;">
61
</td>
<td style="text-align:right;color: 1 !important;">
85
</td>
<td style="text-align:right;color: 1 !important;">
128
</td>
<td style="text-align:right;color: 1 !important;">
220
</td>
<td style="text-align:right;color: 1 !important;">
476
</td>
<td style="text-align:right;color: 1 !important;">
1826
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
1660
</td>
<td style="text-align:right;color: 1 !important;">
393
</td>
<td style="text-align:right;">
165
</td>
<td style="text-align:right;">
87
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
33
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
15
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.45
</td>
<td style="text-align:right;color: 1 !important;">
28
</td>
<td style="text-align:right;color: 1 !important;">
34
</td>
<td style="text-align:right;color: 1 !important;">
43
</td>
<td style="text-align:right;color: 1 !important;">
57
</td>
<td style="text-align:right;color: 1 !important;">
79
</td>
<td style="text-align:right;color: 1 !important;">
119
</td>
<td style="text-align:right;color: 1 !important;">
203
</td>
<td style="text-align:right;color: 1 !important;">
436
</td>
<td style="text-align:right;color: 1 !important;">
1660
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;color: 1 !important;">
1483
</td>
<td style="text-align:right;">
347
</td>
<td style="text-align:right;">
144
</td>
<td style="text-align:right;">
75
</td>
<td style="text-align:right;">
44
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.5
</td>
<td style="text-align:right;color: 1 !important;">
22
</td>
<td style="text-align:right;color: 1 !important;">
26
</td>
<td style="text-align:right;color: 1 !important;">
32
</td>
<td style="text-align:right;color: 1 !important;">
40
</td>
<td style="text-align:right;color: 1 !important;">
53
</td>
<td style="text-align:right;color: 1 !important;">
73
</td>
<td style="text-align:right;color: 1 !important;">
109
</td>
<td style="text-align:right;color: 1 !important;">
184
</td>
<td style="text-align:right;color: 1 !important;">
393
</td>
<td style="text-align:right;color: 1 !important;">
1483
</td>
<td style="text-align:right;color: 1 !important;">
Inf
</td>
<td style="text-align:right;">
1297
</td>
<td style="text-align:right;">
300
</td>
<td style="text-align:right;">
123
</td>
<td style="text-align:right;">
63
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
9
</td>
<td style="text-align:right;">
5
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.55
</td>
<td style="text-align:right;color: red !important;">
18
</td>
<td style="text-align:right;color: red !important;">
21
</td>
<td style="text-align:right;color: red !important;">
25
</td>
<td style="text-align:right;color: red !important;">
30
</td>
<td style="text-align:right;color: red !important;">
37
</td>
<td style="text-align:right;color: red !important;">
48
</td>
<td style="text-align:right;color: red !important;">
66
</td>
<td style="text-align:right;color: red !important;">
98
</td>
<td style="text-align:right;color: red !important;">
165
</td>
<td style="text-align:right;color: red !important;">
347
</td>
<td style="text-align:right;color: red !important;">
1297
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
1108
</td>
<td style="text-align:right;">
253
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.6
</td>
<td style="text-align:right;color: red !important;">
14
</td>
<td style="text-align:right;color: red !important;">
16
</td>
<td style="text-align:right;color: red !important;">
19
</td>
<td style="text-align:right;color: red !important;">
23
</td>
<td style="text-align:right;color: red !important;">
27
</td>
<td style="text-align:right;color: red !important;">
34
</td>
<td style="text-align:right;color: red !important;">
44
</td>
<td style="text-align:right;color: red !important;">
59
</td>
<td style="text-align:right;color: red !important;">
87
</td>
<td style="text-align:right;color: red !important;">
144
</td>
<td style="text-align:right;color: red !important;">
300
</td>
<td style="text-align:right;">
1108
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
918
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
6
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.65
</td>
<td style="text-align:right;color: red !important;">
12
</td>
<td style="text-align:right;color: red !important;">
13
</td>
<td style="text-align:right;color: red !important;">
15
</td>
<td style="text-align:right;color: red !important;">
17
</td>
<td style="text-align:right;color: red !important;">
20
</td>
<td style="text-align:right;color: red !important;">
24
</td>
<td style="text-align:right;color: red !important;">
30
</td>
<td style="text-align:right;color: red !important;">
38
</td>
<td style="text-align:right;color: red !important;">
51
</td>
<td style="text-align:right;color: red !important;">
75
</td>
<td style="text-align:right;color: red !important;">
123
</td>
<td style="text-align:right;">
253
</td>
<td style="text-align:right;">
918
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
732
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
7
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.7
</td>
<td style="text-align:right;color: red !important;">
10
</td>
<td style="text-align:right;color: red !important;">
11
</td>
<td style="text-align:right;color: red !important;">
12
</td>
<td style="text-align:right;color: red !important;">
14
</td>
<td style="text-align:right;color: red !important;">
15
</td>
<td style="text-align:right;color: red !important;">
18
</td>
<td style="text-align:right;color: red !important;">
21
</td>
<td style="text-align:right;color: red !important;">
26
</td>
<td style="text-align:right;color: red !important;">
33
</td>
<td style="text-align:right;color: red !important;">
44
</td>
<td style="text-align:right;color: red !important;">
63
</td>
<td style="text-align:right;">
101
</td>
<td style="text-align:right;">
205
</td>
<td style="text-align:right;">
732
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
555
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.75
</td>
<td style="text-align:right;color: red !important;">
8
</td>
<td style="text-align:right;color: red !important;">
9
</td>
<td style="text-align:right;color: red !important;">
10
</td>
<td style="text-align:right;color: red !important;">
11
</td>
<td style="text-align:right;color: red !important;">
12
</td>
<td style="text-align:right;color: red !important;">
14
</td>
<td style="text-align:right;color: red !important;">
16
</td>
<td style="text-align:right;color: red !important;">
18
</td>
<td style="text-align:right;color: red !important;">
22
</td>
<td style="text-align:right;color: red !important;">
27
</td>
<td style="text-align:right;color: red !important;">
36
</td>
<td style="text-align:right;">
51
</td>
<td style="text-align:right;">
80
</td>
<td style="text-align:right;">
160
</td>
<td style="text-align:right;">
555
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
393
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
10
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.8
</td>
<td style="text-align:right;color: red !important;">
7
</td>
<td style="text-align:right;color: red !important;">
7
</td>
<td style="text-align:right;color: red !important;">
8
</td>
<td style="text-align:right;color: red !important;">
8
</td>
<td style="text-align:right;color: red !important;">
9
</td>
<td style="text-align:right;color: red !important;">
10
</td>
<td style="text-align:right;color: red !important;">
11
</td>
<td style="text-align:right;color: red !important;">
13
</td>
<td style="text-align:right;color: red !important;">
15
</td>
<td style="text-align:right;color: red !important;">
18
</td>
<td style="text-align:right;color: red !important;">
22
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
61
</td>
<td style="text-align:right;">
117
</td>
<td style="text-align:right;">
393
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
251
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.85
</td>
<td style="text-align:right;color: red !important;">
5
</td>
<td style="text-align:right;color: red !important;">
6
</td>
<td style="text-align:right;color: red !important;">
6
</td>
<td style="text-align:right;color: red !important;">
7
</td>
<td style="text-align:right;color: red !important;">
7
</td>
<td style="text-align:right;color: red !important;">
8
</td>
<td style="text-align:right;color: red !important;">
8
</td>
<td style="text-align:right;color: red !important;">
9
</td>
<td style="text-align:right;color: red !important;">
10
</td>
<td style="text-align:right;color: red !important;">
12
</td>
<td style="text-align:right;color: red !important;">
14
</td>
<td style="text-align:right;">
17
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
28
</td>
<td style="text-align:right;">
42
</td>
<td style="text-align:right;">
79
</td>
<td style="text-align:right;">
251
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
20
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.9
</td>
<td style="text-align:right;color: red !important;">
4
</td>
<td style="text-align:right;color: red !important;">
5
</td>
<td style="text-align:right;color: red !important;">
5
</td>
<td style="text-align:right;color: red !important;">
5
</td>
<td style="text-align:right;color: red !important;">
5
</td>
<td style="text-align:right;color: red !important;">
6
</td>
<td style="text-align:right;color: red !important;">
6
</td>
<td style="text-align:right;color: red !important;">
7
</td>
<td style="text-align:right;color: red !important;">
7
</td>
<td style="text-align:right;color: red !important;">
8
</td>
<td style="text-align:right;color: red !important;">
9
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
12
</td>
<td style="text-align:right;">
14
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
46
</td>
<td style="text-align:right;">
134
</td>
<td style="text-align:right;">
Inf
</td>
<td style="text-align:right;">
49
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
0.95
</td>
<td style="text-align:right;color: red !important;">
3
</td>
<td style="text-align:right;color: red !important;">
3
</td>
<td style="text-align:right;color: red !important;">
4
</td>
<td style="text-align:right;color: red !important;">
4
</td>
<td style="text-align:right;color: red !important;">
4
</td>
<td style="text-align:right;color: red !important;">
4
</td>
<td style="text-align:right;color: red !important;">
4
</td>
<td style="text-align:right;color: red !important;">
4
</td>
<td style="text-align:right;color: red !important;">
5
</td>
<td style="text-align:right;color: red !important;">
5
</td>
<td style="text-align:right;color: red !important;">
5
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
6
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
8
</td>
<td style="text-align:right;">
10
</td>
<td style="text-align:right;">
13
</td>
<td style="text-align:right;">
20
</td>
<td style="text-align:right;">
49
</td>
<td style="text-align:right;">
Inf
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="sample-size-for-calibrations" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.3.2</span> 2. Sample size for calibrations<a href="power-and-sample-size.html#sample-size-for-calibrations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="the-calibration-function" class="section level4 hasAnchor">
<h4><span class="header-section-number">9.3.2.1</span> The calibration function<a href="power-and-sample-size.html#the-calibration-function" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The goal is to associate a test value (e.g. RNAseq) to a reference value (e.g. nanostring) via a calibration function.
We collect N samples of paired measured:
<span class="math inline">\(\{(X_i, Y_i), i = 1... N\}\)</span>, where
<span class="math display">\[ X_i = \tilde{X_i} + \epsilon_i^x \\
Y_i = \tilde{Y_i} + \epsilon_i^y\\
\tilde{Y_i} = f_0(\tilde{X_i}) +e_i
\]</span>
where <span class="math inline">\(\epsilon_i^x ,\epsilon_i^y, e_i\)</span> are zero mean errors with variance
<span class="math inline">\(\sigma_i^{x2}, \sigma_i^{y2}, \sigma_0^2\)</span></p>
<p>In simple calibration function, we assume a linear function: <span class="math inline">\(f_0(x) = \beta_0+\beta_1X\)</span>.
We want to estimage <span class="math inline">\(\beta_0, \beta_1\)</span> to solve the calibration function.</p>
<p>Some considerations for calibration function:</p>
<ul>
<li>the variance of the measurement error often depends on the underlying level.</li>
<li>standard deviation for the measurement error is proportional to the underlying value</li>
<li>the CV (SD/mean) of themeasurement error is <strong>approximately a constant</strong></li>
</ul>
<p>therefore the estimate of variance, assuming:
<span class="math display">\[ \sigma_i^x = CV_x \times \tilde{X} \\
\sigma_i^y = CV_x \times \tilde{Y} \\
\]</span></p>
<p>For estimating parameters in calibration function see the reference paper for different senarios.</p>
<div id="sample-size-calculation-for-calictration" class="section level5 hasAnchor">
<h5><span class="header-section-number">9.3.2.1.1</span> Sample size calculation for calictration<a href="power-and-sample-size.html#sample-size-calculation-for-calictration" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><span class="math display">\[
N = max_{k=1..K}\bigg\{\frac{(2Z_{1-\alpha})^2\times \sigma^2(x_k)}{\delta_k^2}\bigg\}\\
\sigma^2(x_k) =(1, x_k)\sum\bigg(1, x_k\bigg)
\]</span></p>
<p><span class="math inline">\(\sum\)</span> is variance, co-variance matrix for estimated intercept and slope of the calibration function.
<span class="math inline">\(\delta_k, k = 1...K\)</span> precision levels.</p>
<p>Parameters to consider before calculation:</p>
<ul>
<li>x0: x value plan to calibrate with estimated calibration equation (e.g. <span class="math inline">\(\beta_0=0, \beta_1=1\)</span>, and this never happens in reality)</li>
<li>d0: 95% CI of calibrated x value</li>
<li>x: emperical observation of targeted distribution (e.g. mRNA levels from RNA seq or from nanostring)</li>
<li>CVx: coefficient variation of measurement X (e.g. nanostring), assume to be constant</li>
<li>CVy: coefficient variation of measurement Y (e.g. RNAseq), assume to be constant</li>
</ul>
</div>
</div>
<div id="sample-size-calculation-examples" class="section level4 tabset hasAnchor">
<h4><span class="header-section-number">9.3.2.2</span> Sample size calculation examples<a href="power-and-sample-size.html#sample-size-calculation-examples" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="cvx-cvy-0.2" class="section level5 hasAnchor">
<h5><span class="header-section-number">9.3.2.2.1</span> CVx= CVy = 0.2<a href="power-and-sample-size.html#cvx-cvy-0.2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">40</span>, <span class="dv">50</span>, <span class="dv">60</span>, <span class="dv">70</span>, <span class="dv">80</span>, <span class="dv">90</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">d0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>, <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb3-3" title="3"></a>
<a class="sourceLine" id="cb3-4" title="4">calc_samplesize &lt;-<span class="st"> </span><span class="cf">function</span>(x0, d0, <span class="dt">x =</span><span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">1000</span>, <span class="dt">length =</span> <span class="dv">1000</span>), <span class="dt">CVx =</span><span class="fl">0.2</span>, <span class="dt">CVy=</span><span class="fl">0.2</span>) {</a>
<a class="sourceLine" id="cb3-5" title="5">  CVcalibration<span class="op">::</span><span class="kw">samplesize</span>(x0, d0,</a>
<a class="sourceLine" id="cb3-6" title="6">    <span class="dt">x =</span> x, <span class="co"># assuming RNAseq raw count data</span></a>
<a class="sourceLine" id="cb3-7" title="7">    <span class="dt">CVx =</span> CVx, <span class="dt">CVy =</span> CVy</a>
<a class="sourceLine" id="cb3-8" title="8">  )</a>
<a class="sourceLine" id="cb3-9" title="9">}</a>
<a class="sourceLine" id="cb3-10" title="10"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb3-11" title="11"><span class="kw">lapply</span>(d0, <span class="cf">function</span>(d) {</a>
<a class="sourceLine" id="cb3-12" title="12">  rst &lt;-<span class="st"> </span><span class="kw">sapply</span>(x0, <span class="cf">function</span>(x) <span class="kw">calc_samplesize</span>(<span class="dt">x0 =</span> x, <span class="dt">d0 =</span> d))</a>
<a class="sourceLine" id="cb3-13" title="13">  tab &lt;-<span class="st"> </span><span class="kw">do.call</span>(<span class="st">&quot;rbind&quot;</span>, rst)</a>
<a class="sourceLine" id="cb3-14" title="14">  <span class="co"># rownames(tab) &lt;- x0</span></a>
<a class="sourceLine" id="cb3-15" title="15">  ymin &lt;-<span class="st"> </span><span class="kw">min</span>(tab)</a>
<a class="sourceLine" id="cb3-16" title="16">  ymax &lt;-<span class="st"> </span><span class="kw">max</span>(tab)</a>
<a class="sourceLine" id="cb3-17" title="17">  <span class="kw">plot</span>(x0, tab[, <span class="dv">1</span>],</a>
<a class="sourceLine" id="cb3-18" title="18">    <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb3-19" title="19">    <span class="dt">ylim =</span> <span class="kw">c</span>(ymin, ymax),</a>
<a class="sourceLine" id="cb3-20" title="20">    <span class="dt">ylab =</span> <span class="st">&quot;N&quot;</span>,</a>
<a class="sourceLine" id="cb3-21" title="21">    <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;d0=&quot;</span>, d)</a>
<a class="sourceLine" id="cb3-22" title="22">  )</a>
<a class="sourceLine" id="cb3-23" title="23">  <span class="kw">lines</span>(x0, tab[, <span class="dv">3</span>], <span class="dt">lty =</span> <span class="dv">3</span>, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">pch =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-24" title="24">  <span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;1 CV known&quot;</span>, <span class="st">&quot;both CVs known&quot;</span>),</a>
<a class="sourceLine" id="cb3-25" title="25">    <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb3-26" title="26">    <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb3-27" title="27">  )</a>
<a class="sourceLine" id="cb3-28" title="28">  <span class="kw">return</span>(<span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb3-29" title="29">})</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-3-1.png" width="864" /></p>
</div>
<div id="cvx0.1-cvy0.05" class="section level5 hasAnchor">
<h5><span class="header-section-number">9.3.2.2.2</span> CVx=0.1, CVy=0.05<a href="power-and-sample-size.html#cvx0.1-cvy0.05" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><img src="_main_files/figure-html/unnamed-chunk-4-1.png" width="864" /></p>
</div>
</div>
</div>
</div>
<div id="choosing-samples-range" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.4</span> Choosing samples range<a href="power-and-sample-size.html#choosing-samples-range" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<blockquote>
<p>There are two important considerations for choosing sampling methods: (i) the
selected Xi values should cover the entire region of interest and (ii) the particular sampling scheme should
help us to obtain an accurate estimate for the calibration function. There are several obvious choices:</p>
</blockquote>
<blockquote>
<ol style="list-style-type: decimal">
<li><p>randomly sampling from the stored samples (sample more from important regaions, but less accurate)</p></li>
<li><p>uniformly sampling from the given interval of interest (more accurate, less samples from important regions to investigate linear assumption) ;</p></li>
<li><p>a hybrid of the aforementioned two sampling methods (balance between above two):</p></li>
</ol>
<ol style="list-style-type: lower-roman">
<li>dividing the range of interest into intervals using the quantiles of the observed samples</li>
<li>uniformly sampling equal number of Xi’s from each of the subintervals.</li>
</ol>
</blockquote>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">set.seed</span>(<span class="dv">789</span>)</a>
<a class="sourceLine" id="cb4-3" title="3">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb4-4" title="4">x1 &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="dv">500</span>, <span class="dv">-1</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb4-5" title="5">qt &lt;-<span class="st"> </span><span class="kw">quantile</span>(x)</a>
<a class="sourceLine" id="cb4-6" title="6">x2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">runif</span>(<span class="dv">100</span>,qt[<span class="dv">1</span>], qt[<span class="dv">2</span>]), <span class="kw">runif</span>(<span class="dv">100</span>, qt[<span class="dv">2</span>], qt[<span class="dv">3</span>]), <span class="kw">runif</span>(<span class="dv">100</span>, qt[<span class="dv">3</span>], qt[<span class="dv">4</span>]), <span class="kw">runif</span>(<span class="dv">100</span>,qt[<span class="dv">4</span>], qt[<span class="dv">5</span>]))</a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw">hist</span>(x, <span class="dt">breaks =</span><span class="dv">30</span>, <span class="dt">main =</span><span class="st">&quot;random sampling&quot;</span>)</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="kw">hist</span>(x1, <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">main =</span><span class="st">&quot;uniform sampling&quot;</span>)</a>
<a class="sourceLine" id="cb4-9" title="9"><span class="kw">hist</span>(x2, <span class="dt">breaks =</span> <span class="dv">30</span>, <span class="dt">main =</span> <span class="st">&quot;hybrid sampling&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-5-1.png" width="768" /></p>
<div id="estimating-coefficient-variation-cv-within-the-same-measures" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.4.1</span> Estimating coefficient variation (CV) within the same measures<a href="power-and-sample-size.html#estimating-coefficient-variation-cv-within-the-same-measures" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li>repeated measures in the same sample to obtain the estimation of CV in both techonologies</li>
</ul>
<div id="consideration-for-prediction-precision" class="section level4 hasAnchor">
<h4><span class="header-section-number">9.4.1.1</span> Consideration for prediction precision<a href="power-and-sample-size.html#consideration-for-prediction-precision" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Calibration can be viewed as a prediction model. Without any error measurement and assuming
constant error variance, a linear model can be used:
<span class="math display">\[Y_i = a\beta X_i +b + \epsilon\]</span></p>
<p>Uncertainy will be considered when translating the cut-off from RNAseq data
to Nanostring. It boils down to estimate with prediction the residual variance.
When a sample of size <span class="math inline">\(n\)</span> is drawn from a normal
distribution, a <span class="math inline">\(1-\alpha\)</span> CI of the unknown population variance is given by
<span class="math display">\[\frac{n-1}{\chi^2_{1-\alpha/2, n-1}}s^2  &lt; \sigma^2 &lt; \frac{n-1}{\chi^2_{\alpha/2, n-1}}s^2\]</span>
The fold change between the bounds (multiplicative margin of error) can be
used as a precision proxy [4].</p>
<p>Formula can be adapted with <span class="math inline">\(p\)</span> parameters [5]. Non linear relationship
can be considered with a restricted cubic splines and k knots (k-1 parameters)
We assume that k = 3f:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">dat &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb5-2" title="2">  <span class="dt">MMOE =</span> <span class="kw">c</span>(<span class="fl">1.1</span>, <span class="fl">1.2</span>),</a>
<a class="sourceLine" id="cb5-3" title="3">  <span class="dt">linear =</span> <span class="kw">c</span>(<span class="dv">235</span>, <span class="dv">71</span>),</a>
<a class="sourceLine" id="cb5-4" title="4">  <span class="dt">non_linear =</span> <span class="kw">c</span>(<span class="dv">238</span>, <span class="dv">74</span>)</a>
<a class="sourceLine" id="cb5-5" title="5"></a>
<a class="sourceLine" id="cb5-6" title="6">)</a>
<a class="sourceLine" id="cb5-7" title="7"></a>
<a class="sourceLine" id="cb5-8" title="8">knitr<span class="op">::</span><span class="kw">kable</span>(dat)</a></code></pre></div>
<table>
<thead>
<tr>
<th style="text-align:right;">
MMOE
</th>
<th style="text-align:right;">
linear
</th>
<th style="text-align:right;">
non_linear
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:right;">
1.1
</td>
<td style="text-align:right;">
235
</td>
<td style="text-align:right;">
238
</td>
</tr>
<tr>
<td style="text-align:right;">
1.2
</td>
<td style="text-align:right;">
71
</td>
<td style="text-align:right;">
74
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="final-consideration-for-sample-size" class="section level3 hasAnchor">
<h3><span class="header-section-number">9.4.2</span> Final consideration for sample size<a href="power-and-sample-size.html#final-consideration-for-sample-size" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The sample size consideration should serve the purpose of analysis, which in our case is calibraion
and agreement test. These two objectives might render different numbers. In order to gurantee
the quality of prelminary analysis, we should take the max{N1, N2, N3}.</p>
</div>
</div>
<div id="reference-1" class="section level2 hasAnchor">
<h2><span class="header-section-number">9.5</span> Reference<a href="power-and-sample-size.html#reference-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>[1]T. K. Koo and M. Y. Li, “A Guideline of Selecting and Reporting Intraclass Correlation Coefficients for Reliability Research”, Journal of Chiropractic Medicine, vol. 15, no. 2, pp. 155-163, Jun. 2016, doi: 10.1016/j.jcm.2016.02.012.</p>
<p>[2]S. D. Walter, M. Eliasziw, and A. Donner, “Sample size and optimal designs for reliability studies”, Statistics in Medicine, vol. 17, no. 1, pp. 101–110, 1998, doi: 10.1002/(SICI)1097-0258(19980115)17:1&lt;101::AID-SIM727&gt;3.0.CO;2-E.</p>
<p>[3] L. Tian, R. A. Durazo-Arvizu, G. Myers, S. Brooks, K. Sarafin, and C. T. Sempos, “The estimation of calibration equations for variables with heteroscedastic measurement errors,” Statistics in Medicine, vol. 33, no. 25, pp. 4420-4436, 2014, doi: 10.1002/sim.6235.</p>
<p>[4]F. E. Harrell Jr., “Regression Modeling Strategies”. Springer International Publishing, 2016</p>
<p>[5]R. D. Riley, J. Ensor, K. I. E. Snell, et al. “Calculating the sample size required for developing a clinical prediction model”. BMJ. 2020</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiplicity.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="detection-limit-of-assays.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
